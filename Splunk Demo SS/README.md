# Splunk Demo Lab  
The following screenshots and descriptions are my experience completeting the [Build a Basic Home Lab](https://www.youtube.com/watch?v=-8X7Ay4YCoA) series by dfir on youtube.
He has been a great resource that I have utilized to learn concepts and tools of cybersecurity before my formal education at San Diego State University on various related topics begins in Fall 2024 and through Spring 2025 
- **Fall 2024** (CS470 Unix System Admin, CS480 Operating Systems, CS 579 Wireless Networks, CS576 Networks and Distributed Systems)
- **Spring 2025** (CS 576 Computer Security, CS596 Repeatable advanced topics (Permanent name and number pending))

## Summary and Purpose: 
The following details the creation of a toy reverse shell malware using Metasploit to infect a local virtual machine via a malicous download link. The irregular traffic is then logged by Sysmon and parsed in splunk using an add-on. Using filters and a table, the data is further organized into intelligence that can be understood and acted upon by other members of a security team to find and fix security threats on a network.

### What is Metasploit? 
Metasploit is a free, open-source framework for pentesting, commonly used by system administrators and hackers alike.

### What is Sysmon?
Per [Microsoft's Article](https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon), "System Monitor (Sysmon) is a Windows system service and device driver that...monitors and logs system activity to the Windows event log. It provides detailed information about process creations, network connections, and changes to file creation time." The events can be collected using Windows Event Collection or SIEM agents. For this demo, Splunk was used to view these events. More information about Sysmon can be read in the previosuly linked article. 

### What is Splunk?
Splunk is a Security Information and Event Management (SIEM) tool developed by Splunk inc. who was acquired by Cisco as of 2024. Splunk, like other SIEM tools, can be used to organize and analyze security events generated by applications or network hardware. By aggregating a large amount of data, patterns and irregularites can be detected for use by cyber teams. 


**Attacker:** Kali Linux Machine
**Defender:** Windows Machine

The first step from the attacking machine is to find a vulnerbility in a system. Using Nmap, a common network mapping tool, I discovered that port 3389 has been left open. This is the remote desktop port used by windows

![Nmap](https://github.com/KellenMurphy60/PersonalRepo/assets/126136167/65e581e0-a1b6-4fa1-8180-284bede8192e)

After identifying the vulnerability the attacking Kali linux machine configured a reverse tcp shell, disguised as a pdf file, to gain administrator access to the defending machine.
![PayloadConfig](https://github.com/KellenMurphy60/PersonalRepo/assets/126136167/08e6e923-482d-4bc1-8502-0b27c6d78716)

![msfvenom payload creation](https://github.com/KellenMurphy60/PersonalRepo/assets/126136167/b1130f14-628a-4a70-88d1-5d65f878e519)

After downloading and running the malicious program, the meterpreter shell opens and allows remote execution on the Attacking machine (Note: Given the toy nature of this demo, windows defender was disabled as it automatically detects malware of this nature, blocking both the download and the execution of such a program.)

![malwareRunning](https://github.com/KellenMurphy60/PersonalRepo/assets/126136167/71ad51b0-a783-4681-b15b-04459228e4b7)

Meterpreter shell being opened: 

**(Not pictured: console access gained using a simple command and multiple harmless commands being run for the purpose of being viewed by event logging software)**
![meterpreter shell](https://github.com/KellenMurphy60/PersonalRepo/assets/126136167/c0254e72-6639-40f1-acc3-6116e2d18157)

After configuring a new index named endpoint, the commands can be viewed albeit in a unparsable form, at this stage the data has been obtained but it needs to be re-organized to be usable. 
Basic filters can be employed to verify that the commands came from 192.168.28.11 (The Attacking Kali Linux Machine) but we can do better than this!

![Splunk1](https://github.com/KellenMurphy60/PersonalRepo/assets/126136167/492bf0e8-ed51-4c7e-b9e9-81f4def9c430)

Filtered by IP: 
![Splunk2](https://github.com/KellenMurphy60/PersonalRepo/assets/126136167/bfbf866d-6795-4b8f-bf14-356332aed7db)

Here we can see the destination port, 3389 (Windows remote desktop) 

![Spunk3](https://github.com/KellenMurphy60/PersonalRepo/assets/126136167/28818444-daae-4d61-93c4-52a9f7eb483f)

By viewing the ParentImage index, we can see the malware originated from Resume.pdf.exe

![S4](https://github.com/KellenMurphy60/PersonalRepo/assets/126136167/7cc02b07-08cf-45f6-8b6c-bcd9c3fe229a)

Finally, by applying more advanced filters and organizing a table we can create usable data that can provide information to a security team and potentially non-technical positions:

![S5](https://github.com/KellenMurphy60/PersonalRepo/assets/126136167/6b3ee2e0-c266-4419-b3a6-adddef15622a)

**That is the totality of the demo!** The scope is fairly limited but seeing as this is my first personal endeavor into cyber, I believe it has been a fine introduction into basic tools and procedures used by both attackers and defenders. 

